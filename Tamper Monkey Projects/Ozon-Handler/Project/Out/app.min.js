!function(){"use strict";var t="ozonItemsList",o="2px solid red",i=function(){return window.LocalStorageUtil.get(t)||[]},n=function(e){return e.replace(e.split("/").at(-2)+"/","")},r=function(e){return e.map(function(e){return e.link+"\t"+n(e.img)})};function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=function(){var n=i();l(document.querySelectorAll('[data-widget="webAspects"] img')).map(function(e){return{domEl:e,imgId:e.src.split("/").at(-1).split(".")[0]}}).forEach(function(t,e){n.find(function(e){return e.img.includes(t.imgId)})&&(t.domEl.parentElement.style.border=o)})};function u(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function d(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach(function(e){var t,n;t=r,n=o[e=e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function s(){window.LocalStorageUtil.delete(t),console.log("Данные удалены."),window.notify("Данные удалены.")}function f(){var e=i(),t=(console.log("already parsed:",e),w()),n=(console.log("page items:",t),t.filter(function(t){return!e.find(function(e){return e.link===t.link})})),n=(console.log("new items:",n),n.concat(e));console.log("already parsed + new items:",n),g(n),window.copyToClipboard(r(t).join("\n"),"Ссылки скопированы в буфер обмена. ".concat(t.length," шт.")),p()}function m(){var e=i(),t=document.querySelector('[data-widget="webGallery"] img').src,n=window.location.href.split("/?")[0],r=t.split("/").at(-1).split(".")[0],t={img:t,link:n,imgKey:r};console.log("Добавлен в список:",t),window.notify("Успех. Добавлен в список: ".concat(t.link)),g([].concat(l(e),[t]))}var w=function(){return l(document.querySelectorAll(".widget-search-result-container a.tile-hover-target")).map(function(e){return{domEl:e,link:e.href.split("/?")[0],img:null==(e=e.querySelector("img"))?void 0:e.src}}).filter(function(e){return e.img}).map(function(e){return d(d({},e),{},{imgKey:e.img.split("/").at(-1).split(".")[0]})})},p=function(){for(var n=w(),r=i(),e=0;e<n.length;e++)!function(e){var t=n[e];r.find(function(e){return e.imgKey===t.imgKey})&&(t.domEl.parentElement.style.border=o)}(e)},g=function(e){window.LocalStorageUtil.set(t,e),console.log("Данные установлены:",e)},y=function(){var e=document.querySelector('[data-widget="webDetailSKU"]'),t=document.createElement("button");t.textContent="Спарсить",t.addEventListener("click",m),e.insertAdjacentElement("beforebegin",t)},e=window.location.href;e.includes("https://www.ozon.ru/product/")?window.sleep(1).then(function(){var e,t;y(),a(),e=document.querySelector('[data-widget="webDetailSKU"]'),(t=document.createElement("button")).textContent="Очистить данные",t.addEventListener("click",s),e.insertAdjacentElement("beforebegin",t)}):(e.includes("https://www.ozon.ru/seller/")||e.includes("https://www.ozon.ru/brand/"))&&window.sleep(1).then(function(){var e,t;e=document.querySelector('[data-widget="column"]'),(t=document.createElement("button")).innerText="Собрать товары",t.addEventListener("click",f),e.insertAdjacentElement("beforeend",t),e=document.querySelector('[data-widget="column"]'),(t=document.createElement("button")).innerText="Очистить данные",t.addEventListener("click",s),e.insertAdjacentElement("beforeend",t)}),window.initializeMethods([s,function(){var e=i();window.copyToClipboard(r(e).join("\n"),"Товары скопированы в буфер обмена. ".concat(e.length," шт."))},function(){var e=i();window.download({content:r(e),headers:"template"},"Ozon-Items","csv")}]),console.log("Удаление товаров - clearParsedItems()\nСкачать товары - downloadParsedItems()\nКопировать в буфер - copyParsedItems()")}();