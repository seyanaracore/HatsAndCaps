!function(){"use strict";function n(){var e=i();window.copyToClipboard(l(e).join("\n"),"Товары скопированы в буфер обмена. ".concat(e.length," шт."))}var t="ozonItemsList",o="2px solid red",i=function(){return window.LocalStorageUtil.get(t)||[]},r=function(e){return e.replace(e.split("/").at(-2)+"/","")},l=function(e){return e.map(function(e){return e.link+"\t"+r(e.img)})},c=function(e){return e.map(function(e){return{img:e.img,imgKey:e.imgKey,link:e.link}})};function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function u(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(t="Object"===t&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(){window.LocalStorageUtil.delete(t),console.log("Данные удалены."),window.notify("Данные удалены.",4)}function d(){var e=i(),n=document.querySelector('[data-widget="webGallery"] img').src,t=window.location.href.split("/?")[0],r=n.split("/").at(-1).split(".")[0],n={img:n,link:t,imgKey:r};console.log("Добавлен в список:",n),window.notify("Успех. Добавлен в список: ".concat(n.link)),p([].concat(u(e),[n]))}var f=function(){var t=i();u(document.querySelectorAll('[data-widget="webAspects"] img')).map(function(e){return{domEl:e,imgId:e.src.split("/").at(-1).split(".")[0]}}).forEach(function(n,e){t.find(function(e){return e.img.includes(n.imgId)})&&(n.domEl.parentElement.style.border=o)})},p=function(e){console.log(e),window.LocalStorageUtil.set(t,e),console.log("Данные установлены:",e)};function m(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(e,n,t){return n&&m(e.prototype,n),t&&m(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var w=e(function e(n,t,r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var o=document.createElement("button");o.innerText=n,o.addEventListener("click",t),r.insertAdjacentElement("beforeend",o)}),y=function(){var e=document.createElement("div");return e.style.position="fixed",e.style.bottom="10px",e.style.left="10px",e.style.zIndex="9999",e.style.padding="10px",e.style.background="aliceblue",e.style.border="1px solid black",e.style.borderRadius="12px",e};function g(n,e){var t,r=Object.keys(n);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(n),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),r.push.apply(r,t)),r}function b(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?g(Object(o),!0).forEach(function(e){var n,t;n=r,t=o[e=e],e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function v(){var e=i(),n=(console.log("Уже были:",e),h()),t=(console.log("Товары на странице:",n),n.filter(function(n){return!e.find(function(e){return e.link===n.link})})),t=(console.log("Новые товары:",t),t.concat(e)),t=(console.log("Старые + новые товары:",t),c(t));p(t),window.copyToClipboard(l(n).join("\n"),"Ссылки скопированы в буфер обмена. ".concat(n.length," шт.")),O()}var h=function(){return u(document.querySelectorAll(".widget-search-result-container a.tile-hover-target")).map(function(e){return{domEl:e,link:e.href.split("/?")[0],img:null==(e=e.querySelector("img"))?void 0:e.src}}).filter(function(e){return e.img}).map(function(e){return b(b({},e),{},{imgKey:e.img.split("/").at(-1).split(".")[0]})})},O=function(){for(var t=h(),r=i(),e=0;e<t.length;e++)!function(e){var n=t[e];r.find(function(e){return e.imgKey===n.imgKey})&&(n.domEl.parentElement.style.border=o)}(e)};var j=window.location.href;j.includes("https://www.ozon.ru/product/")?window.sleep(1).then(function(){var e;f(),e=y(),new w("Спарсить вариант",d,e),new w("Очистить все данные",s,e),new w("Скопировать все данные",n,e),document.body.insertAdjacentElement("beforeend",e)}):(j.includes("https://www.ozon.ru/seller/")||j.includes("https://www.ozon.ru/brand/"))&&window.sleep(1).then(function(){var e;e=y(),new w("Собрать товары",v,e),new w("Очистить все данные",s,e),new w("Скопировать все данные",n,e),document.body.insertAdjacentElement("beforeend",e)}),window.initializeMethods([s,n,function(){var e=i();window.download({content:l(e),headers:"template"},"Ozon-Items","csv")}]),console.log("Удаление товаров - clearParsedItems()\nСкачать товары - downloadParsedItems()\nКопировать в буфер - copyParsedItems()")}();